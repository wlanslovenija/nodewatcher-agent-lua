local a;do local b;b={uuid=nil,host=nil,port=nil}local c=function(d)b=d end;local e=function(f,g)print("push")if not b.uuid or not b.host or not b.port then print("ERROR: Attempted push without configuration.")return end;payload=f:encode(g)if not payload then print("ERROR: Attempted push with invalid payload.")return end;client=net.createConnection(net.TCP,0)client:dns(b.host,function(h,i)client:connect(b.port,i)client:send("POST /push/http/"..b.uuid.." HTTP/1.1\r\n")client:send("Host: "..b.uuid.."\r\n")client:send("Connection: close\r\n")client:send("\r\n")payload=cjson.encode(payload)client:send(payload)client:close()payload=nil;client=nil end)end;local j=function(f,g)local k={[f.name]={}}k[f.name]=g;k[f.name]._meta={version=f.version}return k end;local l=function(m,n)local o={name=m,version=n,encode=j,push=e}return o end;a={configure=c,createModule=l}end;return a
